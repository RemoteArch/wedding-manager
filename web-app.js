const e=e=>new Promise(((r,t)=>{const o=document.createElement("script");o.src=e,o.onload=r,o.onerror=()=>t(new Error(`Failed to load ${e}`)),document.head.appendChild(o)}));window.loadScript=e,"undefined"==typeof React&&await e("https://unpkg.com/react@18/umd/react.production.min.js"),"undefined"==typeof ReactDOM&&await e("https://unpkg.com/react-dom@18/umd/react-dom.production.min.js");const{useState:r,useEffect:t}=React;class o extends React.Component{constructor(e){super(e),this.state={hasError:!1,error:null,errorPageFailed:!1}}static getDerivedStateFromError(e){return{hasError:!0,error:e}}handleRetry=()=>{this.setState({hasError:!1,error:null,errorPageFailed:!1})};handleErrorPageFailed=()=>{this.setState({errorPageFailed:!0})};render(){if(this.state.hasError){const{errorUrl:e}=this.props;return e&&!this.state.errorPageFailed?React.createElement(n,{errorUrl:e,onErrorPageFailed:this.handleErrorPageFailed}):React.createElement(l,{handleRetry:this.handleRetry,error:this.state.error})}return this.props.children}}const n=({errorUrl:e,onErrorPageFailed:o})=>{const[n,s]=r(null);return t((()=>{let r=!0;return a(e).then((e=>{r&&e?.default?s((()=>e.default)):r&&o()})).catch((()=>{r&&o()})),()=>{r=!1}}),[e]),n?React.createElement(n,null):null};let s="";const a=async e=>{s&&(e=s+e);const r=e.includes("?")?"&":"?",t=`${e}${r}_ts=${Date.now()}`,o=await fetch(t),n=await o.text();let a=n;if(/\.jsx$/i.test(e)){window.Babel||await new Promise(((e,r)=>{const t=document.createElement("script");t.src="https://unpkg.com/@babel/standalone/babel.min.js",t.onload=e,t.onerror=()=>r(new Error("Failed to load Babel")),document.head.appendChild(t)}));a=Babel.transform(n,{presets:["react"],sourceType:"module"}).code}const l=new Blob([a],{type:"text/javascript"}),i=URL.createObjectURL(l);try{return await import(i)}finally{URL.revokeObjectURL(i)}};window.loadModule=a;const l=({handleRetry:e,error:r})=>React.createElement("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",padding:"2rem",textAlign:"center"}},React.createElement("p",{style:{color:"#ef4444",marginBottom:"1rem"}},"Une erreur s'est produite lors du chargement."),React.createElement("button",{onClick:e,style:{padding:"0.5rem 1rem",backgroundColor:"var(--color-primary)",color:"white",borderRadius:"0.25rem",border:"none",cursor:"pointer"}},"Réessayer")),i=({url:e,props:r={},errorUrl:t,children:n})=>{if(!e)return null;const s=React.useMemo((()=>React.lazy((async()=>{const r=await a(e),t=r?.default;if(!t)throw new Error("Aucun export par défaut après chargement");return{default:t}}))),[e]);return React.createElement(o,{errorUrl:t},React.createElement(React.Suspense,{fallback:React.createElement("div",null,n)},React.createElement(s,r)))};function c({url:e,props:r={},errorUrl:t,children:o}){return React.createElement(i,{key:e,url:e,props:r,errorUrl:t},o)}class u extends HTMLElement{constructor(){super(),this._url=null,this._errorUrl=null,this._props={},this._children=null,this._root=null,this._observer=null}connectedCallback(){this._children=this.innerHTML,this._root=ReactDOM.createRoot(this),this._collectProps();const e=this.getAttribute("url");this._errorUrl=this.getAttribute("error"),s=this.getAttribute("base-url")||"",e&&(this._url=e,this._render()),this._observer=new MutationObserver((e=>{for(const r of e)"attributes"===r.type&&this._handleAttributeChange(r.attributeName,r.oldValue)})),this._observer.observe(this,{attributes:!0,attributeOldValue:!0})}disconnectedCallback(){this._observer&&this._observer.disconnect(),this._root&&this._root.unmount()}_handleAttributeChange(e,r){const t=this.getAttribute(e);"url"===e?this._url=t:"error"===e?this._errorUrl=t:"base-url"===e?s=t||"":this._props[e]=t,this._render()}_collectProps(){this._props={};for(const e of this.attributes)"url"!==e.name&&"error"!==e.name&&"base-url"!==e.name&&(this._props[e.name]=e.value)}setProps(e){this._props={...this._props,...e},this._render()}getProps(){return this._props}_render(){this._root&&this._url&&this._root.render(React.createElement(c,{url:this._url,props:this._props,errorUrl:this._errorUrl},React.createElement("div",{dangerouslySetInnerHTML:{__html:this._children}})))}}customElements.define("web-app",u);